<mat-toolbar class="main-toolbar">
  <div class="toolbar-content-wrapper">

    <!-- Left Section: Logo -->
    <div class="toolbar-section left">
      <a mat-button routerLink="/feed" class="brand-logo">
        <span class="logo-text">01Blog</span>
      </a>
    </div>

    <span class="toolbar-spacer"></span>

    <!-- Right Section: Actions -->
    <div class="toolbar-section right">
      <ng-container *ngIf="isLoggedIn && currentUser">
        <!-- Create Post Button -->
        <a mat-stroked-button
           routerLink="/post/new"
           *ngIf="!isOnCreatePostPage"
           class="create-post-btn">
          Create Post
        </a>

        <!-- Notifications -->
        <button mat-icon-button 
                routerLink="/notifications" 
                class="icon-btn notification-btn"
                aria-label="View notifications">
          <mat-icon [matBadge]="unreadCount > 0 ? unreadCount : null" 
                    matBadgeColor="warn"
                    matBadgeSize="small">
            notifications
          </mat-icon>
        </button>

        <!-- User Profile Menu -->
        <button mat-button
                [matMenuTriggerFor]="profileMenu" 
                class="profile-btn">
          <img [src]="userAvatarUrl || 'https://www.gravatar.com/avatar/?d=mp'" 
               alt="User Avatar" 
               class="header-avatar">
        </button>
        
        <mat-menu #profileMenu="matMenu" xPosition="before" class="profile-dropdown">
          <div class="profile-menu-header">
            <img [src]="userAvatarUrl || 'https://www.gravatar.com/avatar/?d=mp'" 
                 alt="User Avatar" 
                 class="profile-menu-avatar">
            <div class="profile-info">
              <strong class="profile-username">{{ currentUser.username }}</strong>
            </div>
          </div>
          
          <mat-divider></mat-divider>
          
          <button mat-menu-item routerLink="/profile" class="menu-item">
            <mat-icon>account_circle</mat-icon>
            <span>Profile</span>
          </button>
          
          <button mat-menu-item class="menu-item" (click)="themeService.toggleTheme()">
            <mat-icon>{{ themeService.isDarkMode() ? 'light_mode' : 'dark_mode' }}</mat-icon>
            <span>{{ themeService.isDarkMode() ? 'Light Theme' : 'Dark Theme' }}</span>
          </button>
          
          <button mat-menu-item routerLink="/admin" *ngIf="isAdmin" class="menu-item">
            <mat-icon>admin_panel_settings</mat-icon>
            <span>Admin Dashboard</span>
          </button>
          
          <mat-divider></mat-divider>
          
          <button mat-menu-item (click)="logout()" class="menu-item">
            <mat-icon>logout</mat-icon>
            <span>Sign Out</span>
          </button>
        </mat-menu>
      </ng-container>

      <!-- Guest Actions -->
      <ng-container *ngIf="!isLoggedIn">
        <button mat-icon-button class="icon-btn" (click)="themeService.toggleTheme()" aria-label="Toggle theme">
          <mat-icon>{{ themeService.isDarkMode() ? 'light_mode' : 'dark_mode' }}</mat-icon>
        </button>
      
      </ng-container>
    </div>

  </div>
</mat-toolbar>
